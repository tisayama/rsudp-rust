# Feature Specification: rsudp互換のプロット表示改善 (rsudp Plot Timestamp & Grid Fix)

**Feature Branch**: `015-fix-plot-timestamp`  
**Created**: 2025-12-22  
**Status**: 計画準備完了  
**Input**: User description: "アラートのplot画像で、経過秒数を表示していますが、rsudp実装ではタイムスタンプが表示されています。rsudp実装に合わせてください。また、waveform의グリッドの表示有無も合わせてください。"

## Clarifications

### Session 2025-12-22
- Q: X軸のタイムスタンプ表示形式 → A: 時刻のみ (HH:MM:SS)。日付はプロットのタイトルに含まれるため、X軸ラベルは視認性を重視して `HH:MM:SS` 形式のUTC時刻を表示します。
- Q: 波形プロットのグリッド表示仕様 → A: 非表示 (Hidden)。オリジナルの `rsudp` のスタイルに合わせ、波形プロットセクションのグリッド線（垂直・水平）を完全に削除します。

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 絶対時刻（タイムスタンプ）によるX軸表示 (Priority: P1)

分析者として、生成されたアラート画像で地震イベントの正確な発生時刻を確認したい。現在の「開始からの経過秒数」ではなく、UTC時刻（例: `09:01:23`）がX軸に表示されることで、他の観測データや公式記録との照合が容易になる。

**この優先度の理由**: 地震データの解析において「いつ発生したか」は最も基本的かつ重要な情報であり、`rsudp` との互換性を確保するため。

**Independent Test**: シミュレーターでアラートを発生させ、生成された画像（波形およびスペクトログラム）のX軸ラベルが `HH:MM:SS` 形式のUTC時刻になっていることを確認する。

**Acceptance Scenarios**:

1. **Given** 09:00:00 UTCに開始したデータがある, **When** アラート画像が生成される, **Then** X軸の目盛りが `09:00:00`, `09:00:30`, `09:01:00` のように絶対時刻で表示される。
2. **Given** 波形とスペクトログラムが表示されている, **When** 時間軸を確認する, **Then** 両方のグラフで同じ時刻が垂直に揃っている。

---

### User Story 2 - 波形グリッドの表示制御 (Priority: P2)

管理者として、波形プロットの視認性を `rsudp` と同じにしたい。`rsudp` の波形プロットにはグリッド線が表示されていないため、Rust実装でもそれに倣うことで、違和感のない出力を得る。

**この優先度の理由**: ユーザー体験の一貫性を保つため。

**Independent Test**: 画像を生成し、波形プロット部分に目立つグリッド線が表示されていないことを目視で確認する。

**Acceptance Scenarios**:

1. **Given** アラート画像が生成される, **When** 波形プロットを確認する, **Then** グリッド線が描画されていない。

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: アラート画像の波形プロットおよびスペクトログラムのX軸ラベルを、経過秒数から UTC時刻形式 (`HH:MM:SS`) に変更しなければならない。
- **FR-002**: X軸の目盛り間隔は、表示期間に応じて適切に自動調整されなければならない（例: 90秒のデータなら10秒または15秒間隔）。
- **FR-003**: 波形プロット（上段）のグリッド表示を完全に無効化しなければならない。
- **FR-004**: スペクトログラム（下段）のX軸ラベルのみを表示し、波形プロットのX軸ラベルは省略する（重複を避けるため `rsudp` のレイアウトに従う）。

### Key Entities

- **TimeAxis**: UTC時刻を保持し、プロット上の位置とマッピングするロジック。

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 生成された画像のX軸が、データの開始時刻に基づいた正しいUTC時刻を示していること。
- **SC-002**: 波形プロットの背景が、オリジナルの `rsudp` 出力と視覚的に一致していること（グリッドなし）。
- **SC-003**: 変更後も画像生成時間が 3秒以内（バックグラウンド処理）であること。

## Assumptions

- `rsudp` のデフォルトスタイルに基づき、波形プロットおよびスペクトログラムにはグリッドを表示しない。
- タイムスタンプは UTC を基準とする（`rsudp` の挙動）。